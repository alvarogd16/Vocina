!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).rexlzstringplugin=t()}(this,function(){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function t(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(o){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)}}var n,c=(function(e){var v,n,r,o,i,t=(v=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",o={},i={compressToBase64:function(e){if(null==e)return"";var t=i._compress(e,6,function(e){return n.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:i._decompress(t.length,32,function(e){return s(n,t.charAt(e))})},compressToUTF16:function(e){return null==e?"":i._compress(e,15,function(e){return v(e+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:i._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(e){for(var t=i.compress(e),n=new Uint8Array(2*t.length),r=0,o=t.length;r<o;r++){var s=t.charCodeAt(r);n[2*r]=s>>>8,n[2*r+1]=s%256}return n},decompressFromUint8Array:function(e){if(null==e)return i.decompress(e);for(var t=new Array(e.length/2),n=0,r=t.length;n<r;n++)t[n]=256*e[2*n]+e[2*n+1];var o=[];return t.forEach(function(e){o.push(v(e))}),i.decompress(o.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":i._compress(e,6,function(e){return r.charAt(e)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),i._decompress(t.length,32,function(e){return s(r,t.charAt(e))}))},compress:function(e){return i._compress(e,16,function(e){return v(e)})},_compress:function(e,t,n){if(null==e)return"";var r,o,s,i={},u={},c="",a="",p="",f=2,l=3,h=2,d=[],m=0,y=0;for(s=0;s<e.length;s+=1)if(c=e.charAt(s),Object.prototype.hasOwnProperty.call(i,c)||(i[c]=l++,u[c]=!0),a=p+c,Object.prototype.hasOwnProperty.call(i,a))p=a;else{if(Object.prototype.hasOwnProperty.call(u,p)){if(p.charCodeAt(0)<256){for(r=0;r<h;r++)m<<=1,y==t-1?(y=0,d.push(n(m)),m=0):y++;for(o=p.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1}else{for(o=1,r=0;r<h;r++)m=m<<1|o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o=0;for(o=p.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1}0==--f&&(f=Math.pow(2,h),h++),delete u[p]}else for(o=i[p],r=0;r<h;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1;0==--f&&(f=Math.pow(2,h),h++),i[a]=l++,p=String(c)}if(""!==p){if(Object.prototype.hasOwnProperty.call(u,p)){if(p.charCodeAt(0)<256){for(r=0;r<h;r++)m<<=1,y==t-1?(y=0,d.push(n(m)),m=0):y++;for(o=p.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1}else{for(o=1,r=0;r<h;r++)m=m<<1|o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o=0;for(o=p.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1}0==--f&&(f=Math.pow(2,h),h++),delete u[p]}else for(o=i[p],r=0;r<h;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1;0==--f&&(f=Math.pow(2,h),h++)}for(o=2,r=0;r<h;r++)m=m<<1|1&o,y==t-1?(y=0,d.push(n(m)),m=0):y++,o>>=1;for(;;){if(m<<=1,y==t-1){d.push(n(m));break}y++}return d.join("")},decompress:function(t){return null==t?"":""==t?null:i._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(e,t,n){var r,o,s,i,u,c,a,p=[],f=4,l=4,h=3,d="",m=[],y={val:n(0),position:t,index:1};for(r=0;r<3;r+=1)p[r]=r;for(s=0,u=Math.pow(2,2),c=1;c!=u;)i=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),s|=(0<i?1:0)*c,c<<=1;switch(s){case 0:for(s=0,u=Math.pow(2,8),c=1;c!=u;)i=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),s|=(0<i?1:0)*c,c<<=1;a=v(s);break;case 1:for(s=0,u=Math.pow(2,16),c=1;c!=u;)i=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),s|=(0<i?1:0)*c,c<<=1;a=v(s);break;case 2:return""}for(o=p[3]=a,m.push(a);;){if(y.index>e)return"";for(s=0,u=Math.pow(2,h),c=1;c!=u;)i=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),s|=(0<i?1:0)*c,c<<=1;switch(a=s){case 0:for(s=0,u=Math.pow(2,8),c=1;c!=u;)i=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),s|=(0<i?1:0)*c,c<<=1;p[l++]=v(s),a=l-1,f--;break;case 1:for(s=0,u=Math.pow(2,16),c=1;c!=u;)i=y.val&y.position,y.position>>=1,0==y.position&&(y.position=t,y.val=n(y.index++)),s|=(0<i?1:0)*c,c<<=1;p[l++]=v(s),a=l-1,f--;break;case 2:return m.join("")}if(0==f&&(f=Math.pow(2,h),h++),p[a])d=p[a];else{if(a!==l)return null;d=o+o.charAt(0)}m.push(d),p[l++]=o+d.charAt(0),o=d,0==--f&&(f=Math.pow(2,h),h++)}}});function s(e,t){if(!o[e]){o[e]={};for(var n=0;n<e.length;n++)o[e][e.charAt(n)]=n}return o[e][t]}null!=e&&(e.exports=t)}(n={exports:{}}),n.exports),a=Phaser.Utils.Objects.GetFastValue,p=function(){function t(e){o(this,t),this.resetFromJSON(e)}return e(t,[{key:"resetFromJSON",value:function(e){return this.setEncoding(a(e,"encoding",0)),this}},{key:"toJSON",value:function(){return{encoding:this.encoding}}},{key:"setEncoding",value:function(e){return void 0===e?e=0:"string"==typeof e&&(e=f[e.toLowerCase()]||0),this.encoding=e,this}},{key:"compress",value:function(e){var t=l[this.encoding];return c[t](e)}},{key:"decompress",value:function(e){var t=h[this.encoding];return c[t](e)}}]),t}(),f={none:0,base64:1,utf16:2,uri:3},l=["compress","compressToBase64","compressToUTF16","compressToEncodedURIComponent"],h=["decompress","decompressFromBase64","decompressFromUTF16","decompressFromEncodedURIComponent"];return function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(r,Phaser.Plugins.BasePlugin);var n=t(r);function r(e){var t;return o(this,r),(t=n.call(this,e)).lzstring=new p,t}return e(r,[{key:"start",value:function(){this.game.events.on("destroy",this.destroy,this)}},{key:"destroy",value:function(){this.lzstring=null,this.pluginManager=null,this.game=null,this.scene=null,this.systems=null}},{key:"add",value:function(e){return new p(e)}}]),r}()});
